function SSOController(){var n=this;var d={success:function(z){},error:function(){},complete:function(){}};var s="ssoLoginFrame";var q="ssoLoginForm";var h="";var l="";var w=0;var k=0;var g=null;var o=null;var e=0;var c={};var y="/passport/user/login";var b="/passport/user/register";var u="/passport/user/prelogin";this.verifyCodeUrl="/passport/user/verifycode";this.checkVerifyUrl="/passport/user/loginverifyshow";this.checkVerifyCode="/passport/user/verifycheck";this.checkUserName="/passport/user/checkusername";this.checkNickName="/passport/user/checknickname";this.tpRegister="/passport/user/tpregister";this.tpBind="/passport/user/tpbind";var m=function(z){$(s).remove();var A=$("<iframe></iframe>");A.css("display","none");A.attr("id",z);A.attr("name",z);A.attr("src","javascript:void(0)");A.appendTo("body");return A};var p=function(A){$(q).remove();var B=$("<form></form>");B.attr("id",A);B.attr("name",A);B.attr("method","post");B.css("display","none");for(var z in c){B.append($("<input type='text' name='"+z+"' value='"+c[z]+"' />"))}B.appendTo("body");return B};var r=function(){if(typeof XMLHttpRequest=="undefined"){return false}var z=new XMLHttpRequest();if(!"withCredentials" in z){return false}$.ajax({url:y,data:c,method:"post",dataType:"json",xhrFields:{withCredentials:true},success:function(B){if(B.status==10020){var C='<div style="max-width: 600px;font-size: 14px;line-height: 20px;"><p style="font-size: 16px;line-height: 28px;max-width: 600px;">十分抱歉，由于您的帐号最近在实战中存在严重违规的情况，已做冻结帐号处理</p>'+'<p style="color: #999;margin-top: 30px;">可能导致帐号冻结的原因  <a style="color: #08c !important;" href="http://coding.imooc.com/user/faqdetail?column_id=2&id=17" target="_blank" >了解详情</a></p>'+'<div class="moco-modal-btns"><a class="moco-btn moco-btn-blue js-modal-submit js-warn-close" onclick="return false" href="javascript:void(0)"><span>确定</span></a></div></div>';$.dialog(C,{title:"提示",modal:true});$("#signin").remove();$(".modal-backdrop").remove()}else{if(B.status==10021){var C='<div style="font-size: 14px;line-height: 20px;"><p style="font-size: 16px;line-height: 28px;max-width: 600px;">十分抱歉，由于您的账号最近在实战中被多次警告，已做冻结账号处理</p>'+'<p style="color: #999;margin-top: 30px;">可能导致帐号冻结的原因  <a style="color: #08c !important;" href="http://coding.imooc.com/user/faqdetail?column_id=2&id=17" target="_blank" >了解详情</a></p>'+'<div class="moco-modal-btns"><a class="moco-btn moco-btn-blue js-modal-submit js-warn-close" onclick="return false" href="javascript:void(0)"><span>确定</span></a></div></div>';$.dialog(C,{title:"提示",modal:true});$("#signin").remove();$(".modal-backdrop").remove()}else{if(B.status==10022){var C='<div style="font-size: 14px;line-height: 20px;"><p style="font-size: 16px;line-height: 28px;max-width: 600px;">十分抱歉，由于您的账号最近在慕课网被多次警告，已做冻结账号处理</p>'+'<div class="moco-modal-btns"><a class="moco-btn moco-btn-blue js-modal-submit js-warn-close" onclick="return false" href="javascript:void(0)"><span>确定</span></a></div></div>';$.dialog(C,{title:"提示",modal:true});$("#signin").remove();$(".modal-backdrop").remove()}else{if(B.status==10006){var C='<div style="font-size: 14px;line-height: 20px;"><p style="font-size: 16px;line-height: 28px;max-width: 600px;">十分抱歉，由于您的帐号最近在慕课网中存在严重违规的情况，已做冻结帐号处理</p>'+'<div class="moco-modal-btns"><a class="moco-btn moco-btn-blue js-modal-submit js-warn-close" onclick="return false" href="javascript:void(0)"><span>确定</span></a></div></div>';$.dialog(C,{title:"提示",modal:true});$("#signin").remove();$(".modal-backdrop").remove()}else{if(B.status==10001){if(B.caution){var C='<div style="font-size: 14px;line-height: 20px;"><p style="font-size: 16px;line-height: 28px;max-width: 600px;">'+B.caution+"</p>"+'<div class="moco-modal-btns"><a class="moco-btn moco-btn-blue js-modal-close js-warn-close" onclick="return false" href="javascript:void(0)"><span>确定</span></a></div></div>';$("#signin").remove();$(".modal-backdrop").remove();$.dialog(C,{title:"警告",modal:true,callback:function(){n.ssoLoginCallBack(B)}})}else{n.ssoLoginCallBack(B)}}else{n.ssoLoginCallBack(B)}}}}}if($(".js-warn-close").size()>0){var A=function(){$(".moco-modal-layer").remove();$(".js-moco-modal-cancel").remove()};$(document).on("click",".js-warn-close",A)}},error:function(){c.returntype="html";x()}});return true};var a=function(){if(typeof XMLHttpRequest=="undefined"){return false}var z=new XMLHttpRequest();$.ajax({url:b,data:c,method:"post",dataType:"json",success:function(A){n.ssoLoginCallBack(A)},error:function(){c.returntype="html";v()}});return true};var x=function(){m(s);var A=p(q);A.attr("action",y);A.attr("target",s);try{A.submit()}catch(z){$(s).remove()}setTimeout(function(){$(A).remove()},10)};var v=function(){m(s);var A=p(q);A.attr("action",b);A.attr("target",s);try{A.submit()}catch(z){$(s).remove()}setTimeout(function(){$(A).remove()},10)};var f=function(z){clearInterval(k);k=null;h=z.pubkey;l=z.code;w=z.servertime;setInterval(function(){w++},1000)};this.preLogin=function(z){if(h&&l){z.success&&z.success();return}z=z||{success:function(){},error:function(){}};
$.ajax({url:u,method:"post",dataType:"json",success:function(A){if(A.status==10001){f(A);z.success&&z.success()}else{z.error&&z.error()}},error:function(){z.error()}})};this.setCrossDomainCookie=function(A){e=A.length;for(var z=0;z<A.length;z++){url=A[z];$.get(url,function(B){e--;if(e==0){clearTimeout(o);n.crossDomainResult()}},"jsonp")}};this.ssoLoginCallBack=function(z){if(z.status==10001){g=function(){d.success(z);d.complete()};this.setCrossDomainCookie(z.data.url);o=setTimeout(function(){n.crossDomainResult()},5000)}else{d.success(z);d.complete()}};this.crossDomainResult=function(){if(typeof g=="function"){g()}};this.crossDomainAction=function(z){if(typeof z=="function"){g=z}o=setTimeout(function(){n.crossDomainResult()},5000);return false};this.frameLoginCallBack=function(z){d.success(z);d.complete();$(s).remove()};this.login=function(A){if(A.data.pwencode){if(l==""||w==0||h==""){A.error();A.complete();this.preLogin();return}var z=t(l+"\t"+w+"\t"+A.data.password);A.data.password=window.btoa(z)}c=A.data;c.referer=window.location.protocol+"//"+window.location.hostname;d={success:A.success,error:A.error,complete:A.complete};if(r()){return true}else{c.returntype="html";x()}};this.register=function(z){d={success:z.success,error:z.error,complete:z.complete};c=z.data;c.referer=window.location.protocol+"//"+window.location.hostname;if(a()){return true}else{c.returntype="html";v()}};var t=function(ao){var aH=2;var ak=16;var M=ak;var av=1<<16;var D=av>>>1;var aq=av*av;var ay=av-1;var aE=9999999999999998;var az;var aF;var K,B;function U(aK){az=aK;aF=new Array(az);for(var aJ=0;aJ<aF.length;aJ++){aF[aJ]=0}K=new A();B=new A();B.digits[0]=1}U(20);var al=15;var ap=O(1000000000000000);function A(aJ){if(typeof aJ=="boolean"&&aJ==true){this.digits=null}else{this.digits=aF.slice(0)}this.isNeg=false}function P(aN){var aM=aN.charAt(0)=="-";var aL=aM?1:0;var aJ;while(aL<aN.length&&aN.charAt(aL)=="0"){++aL}if(aL==aN.length){aJ=new A()}else{var aK=aN.length-aL;var aO=aK%al;if(aO==0){aO=al}aJ=O(Number(aN.substr(aL,aO)));aL+=aO;while(aL<aN.length){aJ=F(aI(aJ,ap),O(Number(aN.substr(aL,al))));aL+=al}aJ.isNeg=aM}return aJ}function au(aK){var aJ=new A(true);aJ.digits=aK.digits.slice(0);aJ.isNeg=aK.isNeg;return aJ}function O(aL){var aJ=new A();aJ.isNeg=aL<0;aL=Math.abs(aL);var aK=0;while(aL>0){aJ.digits[aK++]=aL&ay;aL>>=ak}return aJ}function X(aL){var aJ="";for(var aK=aL.length-1;aK>-1;--aK){aJ+=aL.charAt(aK)}return aJ}var C=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");function at(aL,aN){var aK=new A();aK.digits[0]=aN;var aM=W(aL,aK);var aJ=C[aM[1].digits[0]];while(E(aM[0],K)==1){aM=W(aM[0],aK);digit=aM[1].digits[0];aJ+=C[aM[1].digits[0]]}return(aL.isNeg?"-":"")+X(aJ)}function aG(aL){var aK=new A();aK.digits[0]=10;var aM=W(aL,aK);var aJ=String(aM[1].digits[0]);while(E(aM[0],K)==1){aM=W(aM[0],aK);aJ+=String(aM[1].digits[0])}return(aL.isNeg?"-":"")+X(aJ)}var J=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function aw(aL){var aK=15;var aJ="";for(i=0;i<4;++i){aJ+=J[aL&aK];aL>>>=4}return X(aJ)}function ac(aK){var aJ="";var aM=aA(aK);for(var aL=aA(aK);aL>-1;--aL){aJ+=aw(aK.digits[aL])}return aJ}function aa(aQ){var aL=48;var aK=aL+9;var aM=97;var aP=aM+25;var aO=65;var aN=65+25;var aJ;if(aQ>=aL&&aQ<=aK){aJ=aQ-aL}else{if(aQ>=aO&&aQ<=aN){aJ=10+aQ-aO}else{if(aQ>=aM&&aQ<=aP){aJ=10+aQ-aM}else{aJ=0}}}return aJ}function am(aM){var aK=0;var aJ=Math.min(aM.length,4);for(var aL=0;aL<aJ;++aL){aK<<=4;aK|=aa(aM.charCodeAt(aL))}return aK}function aB(aN){var aK=new A();var aJ=aN.length;for(var aM=aJ,aL=0;aM>0;aM-=4,++aL){aK.digits[aL]=am(aN.substr(Math.max(aM-4,0),Math.min(aM,4)))}return aK}function ad(aR,aQ){var aJ=aR.charAt(0)=="-";var aM=aJ?1:0;var aS=new A();var aK=new A();aK.digits[0]=1;for(var aL=aR.length-1;aL>=aM;aL--){var aN=aR.charCodeAt(aL);var aO=aa(aN);var aP=H(aK,aO);aS=F(aS,aP);aK=H(aK,aQ)}aS.isNeg=aJ;return aS}function ae(aK){var aJ="";for(var aL=aA(aK);aL>-1;--aL){aJ+=ab(aK.digits[aL])}return aJ}function ab(aL){var aK=String.fromCharCode(aL&255);aL>>>=8;var aJ=String.fromCharCode(aL&255);return aJ+aK}function af(aJ){return(aJ.isNeg?"-":"")+aJ.digits.join(" ")}function F(aK,aO){var aJ;if(aK.isNeg!=aO.isNeg){aO.isNeg=!aO.isNeg;aJ=ax(aK,aO);aO.isNeg=!aO.isNeg}else{aJ=new A();var aN=0;var aM;for(var aL=0;aL<aK.digits.length;++aL){aM=aK.digits[aL]+aO.digits[aL]+aN;aJ.digits[aL]=aM&65535;aN=Number(aM>=av)}aJ.isNeg=aK.isNeg}return aJ}function ax(aK,aO){var aJ;if(aK.isNeg!=aO.isNeg){aO.isNeg=!aO.isNeg;aJ=F(aK,aO);aO.isNeg=!aO.isNeg}else{aJ=new A();var aN,aM;aM=0;for(var aL=0;aL<aK.digits.length;++aL){aN=aK.digits[aL]-aO.digits[aL]+aM;aJ.digits[aL]=aN&65535;if(aJ.digits[aL]<0){aJ.digits[aL]+=av}aM=0-Number(aN<0)}if(aM==-1){aM=0;for(var aL=0;aL<aK.digits.length;++aL){aN=0-aJ.digits[aL]+aM;aJ.digits[aL]=aN&65535;if(aJ.digits[aL]<0){aJ.digits[aL]+=av}aM=0-Number(aN<0)}aJ.isNeg=!aK.isNeg}else{aJ.isNeg=aK.isNeg}}return aJ
}function aA(aK){var aJ=aK.digits.length-1;while(aJ>0&&aK.digits[aJ]==0){--aJ}return aJ}function aj(aL){var aN=aA(aL);var aM=aL.digits[aN];var aK=(aN+1)*M;var aJ;for(aJ=aK;aJ>aK-M;--aJ){if((aM&32768)!=0){break}aM<<=1}return aJ}function aI(aP,aO){var aS=new A();var aN;var aK=aA(aP);var aR=aA(aO);var aQ,aJ,aL;for(var aM=0;aM<=aR;++aM){aN=0;aL=aM;for(j=0;j<=aK;++j,++aL){aJ=aS.digits[aL]+aP.digits[j]*aO.digits[aM]+aN;aS.digits[aL]=aJ&ay;aN=aJ>>>ak}aS.digits[aM+aK+1]=aN}aS.isNeg=aP.isNeg!=aO.isNeg;return aS}function H(aJ,aO){var aN,aM,aL;result=new A();aN=aA(aJ);aM=0;for(var aK=0;aK<=aN;++aK){aL=result.digits[aK]+aJ.digits[aK]*aO+aM;result.digits[aK]=aL&ay;aM=aL>>>ak}result.digits[1+aN]=aM;return result}function V(aN,aQ,aL,aP,aO){var aJ=Math.min(aQ+aO,aN.length);for(var aM=aQ,aK=aP;aM<aJ;++aM,++aK){aL[aK]=aN[aM]}}var N=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535);function S(aK,aQ){var aM=Math.floor(aQ/M);var aJ=new A();V(aK.digits,0,aJ.digits,aM,aJ.digits.length-aM);var aP=aQ%M;var aL=M-aP;for(var aN=aJ.digits.length-1,aO=aN-1;aN>0;--aN,--aO){aJ.digits[aN]=((aJ.digits[aN]<<aP)&ay)|((aJ.digits[aO]&N[aP])>>>(aL))}aJ.digits[0]=((aJ.digits[aN]<<aP)&ay);aJ.isNeg=aK.isNeg;return aJ}var ag=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);function I(aK,aQ){var aL=Math.floor(aQ/M);var aJ=new A();V(aK.digits,aL,aJ.digits,0,aK.digits.length-aL);var aO=aQ%M;var aP=M-aO;for(var aM=0,aN=aM+1;aM<aJ.digits.length-1;++aM,++aN){aJ.digits[aM]=(aJ.digits[aM]>>>aO)|((aJ.digits[aN]&ag[aO])<<aP)}aJ.digits[aJ.digits.length-1]>>>=aO;aJ.isNeg=aK.isNeg;return aJ}function Y(aK,aL){var aJ=new A();V(aK.digits,0,aJ.digits,aL,aJ.digits.length-aL);return aJ}function G(aK,aL){var aJ=new A();V(aK.digits,aL,aJ.digits,0,aJ.digits.length-aL);return aJ}function ar(aK,aL){var aJ=new A();V(aK.digits,0,aJ.digits,0,aL);return aJ}function E(aJ,aL){if(aJ.isNeg!=aL.isNeg){return 1-2*Number(aJ.isNeg)}for(var aK=aJ.digits.length-1;aK>=0;--aK){if(aJ.digits[aK]!=aL.digits[aK]){if(aJ.isNeg){return 1-2*Number(aJ.digits[aK]>aL.digits[aK])}else{return 1-2*Number(aJ.digits[aK]<aL.digits[aK])}}}return 0}function W(aO,aN){var aJ=aj(aO);var aM=aj(aN);var aL=aN.isNeg;var aT,aS;if(aJ<aM){if(aO.isNeg){aT=au(B);aT.isNeg=!aN.isNeg;aO.isNeg=false;aN.isNeg=false;aS=ax(aN,aO);aO.isNeg=true;aN.isNeg=aL}else{aT=new A();aS=au(aO)}return new Array(aT,aS)}aT=new A();aS=aO;var aQ=Math.ceil(aM/M)-1;var aP=0;while(aN.digits[aQ]<D){aN=S(aN,1);++aP;++aM;aQ=Math.ceil(aM/M)-1}aS=S(aS,aP);aJ+=aP;var aW=Math.ceil(aJ/M)-1;var a1=Y(aN,aW-aQ);while(E(aS,a1)!=-1){++aT.digits[aW-aQ];aS=ax(aS,a1)}for(var aZ=aW;aZ>aQ;--aZ){var aR=(aZ>=aS.digits.length)?0:aS.digits[aZ];var a0=(aZ-1>=aS.digits.length)?0:aS.digits[aZ-1];var aY=(aZ-2>=aS.digits.length)?0:aS.digits[aZ-2];var aX=(aQ>=aN.digits.length)?0:aN.digits[aQ];var aK=(aQ-1>=aN.digits.length)?0:aN.digits[aQ-1];if(aR==aX){aT.digits[aZ-aQ-1]=ay}else{aT.digits[aZ-aQ-1]=Math.floor((aR*av+a0)/aX)}var aV=aT.digits[aZ-aQ-1]*((aX*av)+aK);var aU=(aR*aq)+((a0*av)+aY);while(aV>aU){--aT.digits[aZ-aQ-1];aV=aT.digits[aZ-aQ-1]*((aX*av)|aK);aU=(aR*av*av)+((a0*av)+aY)}a1=Y(aN,aZ-aQ-1);aS=ax(aS,H(a1,aT.digits[aZ-aQ-1]));if(aS.isNeg){aS=F(aS,a1);--aT.digits[aZ-aQ-1]}}aS=I(aS,aP);aT.isNeg=aO.isNeg!=aL;if(aO.isNeg){if(aL){aT=F(aT,B)}else{aT=ax(aT,B)}aN=I(aN,aP);aS=ax(aN,aS)}if(aS.digits[0]==0&&aA(aS)==0){aS.isNeg=false}return new Array(aT,aS)}function aD(aJ,aK){return W(aJ,aK)[0]}function Z(aJ,aK){return W(aJ,aK)[1]}function R(aK,aL,aJ){return Z(aI(aK,aL),aJ)}function ai(aK,aM){var aJ=B;var aL=aK;while(true){if((aM&1)!=0){aJ=aI(aJ,aL)}aM>>=1;if(aM==0){break}aL=aI(aL,aL)}return aJ}function ah(aL,aO,aK){var aJ=B;var aM=aL;var aN=aO;while(true){if((aN.digits[0]&1)!=0){aJ=R(aJ,aM,aK)}aN=I(aN,1);if(aN.digits[0]==0&&aA(aN)==0){break}aM=R(aM,aM,aK)}return aJ}function z(aJ){this.modulus=au(aJ);this.k=aA(this.modulus)+1;var aK=new A();aK.digits[2*this.k]=1;this.mu=aD(aK,this.modulus);this.bkplus1=new A();this.bkplus1.digits[this.k+1]=1;this.modulo=L;this.multiplyMod=an;this.powMod=T}function L(aQ){var aP=G(aQ,this.k-1);var aN=aI(aP,this.mu);var aM=G(aN,this.k+1);var aL=ar(aQ,this.k+1);var aR=aI(aM,this.modulus);var aK=ar(aR,this.k+1);var aJ=ax(aL,aK);if(aJ.isNeg){aJ=F(aJ,this.bkplus1)}var aO=E(aJ,this.modulus)>=0;while(aO){aJ=ax(aJ,this.modulus);aO=E(aJ,this.modulus)>=0}return aJ}function an(aJ,aL){var aK=aI(aJ,aL);return this.modulo(aK)}function T(aK,aN){var aJ=new A();aJ.digits[0]=1;var aL=aK;var aM=aN;while(true){if((aM.digits[0]&1)!=0){aJ=this.multiplyMod(aJ,aL)}aM=I(aM,1);if(aM.digits[0]==0&&aA(aM)==0){break}aL=this.multiplyMod(aL,aL)}return aJ}function aC(aJ){var aK=1024;this.e=aB("10001");this.d=aB("");this.m=aB(aJ);if(typeof(aK)!="number"){this.chunkSize=2*aA(this.m)}else{this.chunkSize=aK/8}this.radix=16;this.barrett=new z(this.m)}function Q(aX){var aS=new Array();var aJ=aX.length;var aN,aM,aL;var aO=2;var aR=1;var aP;var aQ;var aW="";var aK;var aV;var aU;var aT=new aC(h);if(aJ>(aT.chunkSize-11)){aJ=aT.chunkSize-11
}aN=0;aM=aJ-1;while(aN<aJ){aS[aM]=aX.charCodeAt(aN);aN++;aM--}aM=aT.chunkSize-(aJ%aT.chunkSize);while(aM>0){aP=Math.floor(Math.random()*256);while(!aP){aP=Math.floor(Math.random()*256)}aS[aN]=aP;aN++;aM--}aS[aJ]=0;aS[aT.chunkSize-2]=2;aS[aT.chunkSize-1]=0;aQ=aS.length;for(aN=0;aN<aQ;aN+=aT.chunkSize){aK=new A();aM=0;for(aL=aN;aL<(aN+aT.chunkSize);++aM){aK.digits[aM]=aS[aL++];aK.digits[aM]+=aS[aL++]<<8}aV=aT.barrett.powMod(aK,aT.e);aU=ae(aV);aW+=aU}return aW}U(131);return Q(ao)}}(function(){var b=typeof exports!="undefined"?exports:self;var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(d){this.message=d}a.prototype=new Error;a.prototype.name="InvalidCharacterError";b.btoa||(b.btoa=function(g){var l=String(g);for(var k,e,d=0,h=c,f="";l.charAt(d|0)||(h="=",d%1);f+=h.charAt(63&k>>8-d%1*8)){e=l.charCodeAt(d+=3/4);if(e>255){throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.")}k=k<<8|e}return f});b.atob||(b.atob=function(g){var l=String(g).replace(/=+$/,"");if(l.length%4==1){throw new a("'atob' failed: The string to be decoded is not correctly encoded.")}for(var k=0,h,e,d=0,f="";e=l.charAt(d++);~e&&(h=k%4?h*64+e:e,k++%4)?f+=String.fromCharCode(255&h>>(-2*k&6)):0){e=c.indexOf(e)}return f})}());imoocSSO=new SSOController();